{{config(materialized ='table')}}

WITH TRIPS AS (
SELECT
RIDE_ID,
RIDEABLE_TYPE,
DATE(TRY_TO_TIMESTAMP(STARTED_AT)) AS TRIP_DATE,
START_STATIO_ID AS START_STATION_ID,
END_STATION_ID,
MEMBER_CSUAL AS MEMBER_CASUAL,
TIMESTAMPDIFF(SECOND,TRY_TO_TIMESTAMP(STARTED_AT),TRY_TO_TIMESTAMP(ENDED_AT)) AS TRIP_DURATION_SECONDS
FROM {{ source('demo', 'bike') }}
WHERE RIDE_ID != 'ride_id'
)
SELECT
*
FROM TRIPS